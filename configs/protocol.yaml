protocol:
  version: "v1"
  name: "default"
  notes: "Global research protocol (locked)."

paths:
  price_dir_active: "../data/prices"
  price_dir_delisted: "../data/prices_delisted"
  price_dir_active_adj: "../data/prices_divadj"
  price_dir_delisted_adj: "../data/prices_delisted_divadj"
  delisted_info: "../data/delisted_companies_2010_2026.csv"
  earnings_dir: "../data/Owner_Earnings"
  fundamentals_dir: "../data/fmp/ratios/quality"
  value_dir: "../data/fmp/ratios/value"
  industry_map_path: "../data/company_profiles.csv"
  market_cap_dir: "../data/fmp/market_cap_history"

calendar:
  calendar_symbol: "SPY"
  rebalance_mode: null

universe:
  min_market_cap: 500000000.0
  min_dollar_volume: 1000000.0
  min_price: 5.0
  max_volatility: null
  vol_lookback: null
  exclude_symbols_path: /Users/hui/quant_score/v4/data/fmp/missing_delisted_adj_us_blacklist.txt
  market_cap_strict: true

execution:
  rebalance_freq: 21
  holding_period: 21
  execution_delay: 1
  transaction_cost: 0.0020
  execution_use_trading_days: true
  enable_dynamic_cost: true
  trade_size_usd: 10000
  long_pct: 0.2
  short_pct: 0.0

neutralization:
  industry_neutral: false
  industry_min_group: 3
  industry_col: "industry"
  signal_zscore: false
  signal_winsor_z: null
  signal_winsor_pct_low: 0.01
  signal_winsor_pct_high: 0.99
  signal_rank: true
  signal_rank_method: "average"
  signal_rank_pct: true
  signal_missing_policy: "drop"
  signal_missing_fill: null
  signal_smooth_window: null
  signal_smooth_method: "sma"
  signal_smooth_alpha: null
  signal_neutralize_size: false
  signal_neutralize_beta: false
  signal_neutralize_cols: null

factors:
  lag_days: 0
  include_components: false
  weights: {}
  momentum:
    lookback: 126
    skip: 21
    vol_lookback: null
    lag_days: null
    use_monthly: false
    lookback_months: 6
    skip_months: 1
    zscore: false
    winsor_z: null
  pead:
    sue_threshold: 0.5
    lookback_quarters: 8
    date_shift_days: 0
    use_trading_day_shift: true
    event_max_age_days: 5
    lag_days: null
    use_shifted_factor: true
  reversal:
    lookback: 3
    mode: "intraday"
    vol_lookback: 20
    earnings_filter_days: 1
    lag_days: null
  quality:
    weights:
      roe: 1.0
      gross_margin: 1.0
      cfo_to_assets: 1.0
    max_staleness_days: 270
    lag_days: null
  value:
    weights:
      earnings_yield: 1.0
      fcf_yield: 1.0
      ev_ebitda_yield: 1.0
    max_staleness_days: 270
    lag_days: null
  low_vol:
    lag_days: null
  beta:
    lookback: 252
    bench_symbol: "SPY"
    use_log_return: true
    lag_days: null

data_selection:
  use_adj_prices: true
